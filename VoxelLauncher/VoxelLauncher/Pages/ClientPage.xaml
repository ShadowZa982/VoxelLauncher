<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="VoxelLauncher.Pages.ClientPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:VoxelLauncher.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="Transparent">

    <Page.Resources>
        <local:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

        <Style TargetType="TextBlock" x:Key="InfoTextStyle">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="#E0E7FF"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>
        <Style TargetType="TextBlock" x:Key="LabelTextStyle">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#A5B4FC"/>
            <Setter Property="Margin" Value="0,8,0,2"/>
        </Style>
    </Page.Resources>

    <Grid>
        <!-- ====================== MAIN UI ====================== -->
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Padding="20" Spacing="20">
                <Border x:Name="HeroCard"
        Height="520"
        CornerRadius="16"
        Background="#11004488"
        BorderBrush="#44FFFFFF"
        BorderThickness="1"
        Margin="0,0,0,10">
                    <Border.Shadow>
                        <ThemeShadow/>
                    </Border.Shadow>

                    <Grid>
                        <!-- 1. ẢNH NỀN (DƯỚI CÙNG) -->
                        <Image x:Name="ClientHeroImage"
               Stretch="UniformToFill"/>

                        <!-- 2. LỚP ĐÈ MÀU ĐEN (NỬA TRONG SUỐT) -->
                        <Border x:Name="HeroOverlay"
                Background="#AA000000"
                CornerRadius="16"
                Opacity="0.65"
                IsHitTestVisible="False"/>

                        <!-- 3. NỘI DUNG TEXT + NÚT (TRÊN CÙNG) -->
                        <StackPanel x:Name="ClientHeroOverlay"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    IsHitTestVisible="True"
                    Opacity="1">
                            <TextBlock x:Name="HeroTitle"
                       Text="Sẵn sàng chơi"
                       FontSize="36"
                       Foreground="White"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       TextWrapping="Wrap"
                       Margin="0,0,0,8"/>

                            <!-- NÚT CHƠI NGAY -->
                            <Button x:Name="QuickPlayButton"
                    Content="CHƠI NGAY"
                    FontSize="28"
                    Padding="40,16"
                    Margin="0,24,0,0"
                    Background="#10B981"
                    Foreground="White"
                    CornerRadius="16"
                    Click="QuickPlayButton_Click"
                    HorizontalAlignment="Center">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Grid>
                                                        <Border Background="{TemplateBinding Background}"
                                                CornerRadius="{TemplateBinding CornerRadius}"
                                                Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                                        </Border>
                                                        <VisualStateManager.VisualStateGroups>
                                                            <VisualStateGroup x:Name="CommonStates">
                                                                <VisualState x:Name="Normal"/>
                                                                <VisualState x:Name="PointerOver">
                                                                    <Storyboard>
                                                                        <DoubleAnimation Storyboard.TargetName="ScaleTransform"
                                                                         Storyboard.TargetProperty="ScaleX"
                                                                         To="1.05" Duration="0:0:0.2"/>
                                                                        <DoubleAnimation Storyboard.TargetName="ScaleTransform"
                                                                         Storyboard.TargetProperty="ScaleY"
                                                                         To="1.05" Duration="0:0:0.2"/>
                                                                    </Storyboard>
                                                                </VisualState>
                                                            </VisualStateGroup>
                                                        </VisualStateManager.VisualStateGroups>
                                                        <Grid.RenderTransform>
                                                            <ScaleTransform x:Name="ScaleTransform" CenterX="0.5" CenterY="0.5"/>
                                                        </Grid.RenderTransform>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <!-- NÚT TẠO PROFILE -->
                            <Button Content="Quản lý Profile"
                                    FontSize="16"
                                    Margin="0,16,0,0"
                                    Padding="16,8"
                                    Background="#6366F1"
                                    Foreground="White"
                                    CornerRadius="8"
                                    Click="SelectVersionButton_Click"
                                    HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- MAIN CONTENT -->
                <Grid x:Name="MainContentGrid">
                    <!-- CLIENT UI -->
                    <Border x:Name="ClientContentBorder"
                            Background="#11002266"
                            BorderBrush="#44FFFFFF"
                            BorderThickness="1"
                            CornerRadius="12"
                            Padding="35">
                        <Grid RowSpacing="16" ColumnSpacing="20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Cột 1: Phiên bản + Progress -->
                            <StackPanel Grid.Row="0" Grid.Column="0" Spacing="12">
                                <TextBlock Text="Phiên bản Minecraft" FontSize="18" Foreground="#93C5FD" FontWeight="SemiBold"/>
                                <Border Background="#1E293B" CornerRadius="8" Padding="12" Margin="0,16,0,0">
                                    <StackPanel Spacing="8">
                                        <ProgressBar x:Name="InstallProgress"
                                                     Height="32"
                                                     Value="0"
                                                     Maximum="100"
                                                     Foreground="#10B981"
                                                     Background="#1F2937"
                                                     CornerRadius="16"
                                                     Visibility="Collapsed"/>
                                        <ScrollViewer MaxHeight="120" Background="#0F172A" CornerRadius="6" Padding="8">
                                            <TextBlock x:Name="ProgressLogText"
                                                       Text="Sẵn sàng..."
                                                       FontFamily="Consolas"
                                                       FontSize="12"
                                                       Foreground="#94A3B8"
                                                       TextWrapping="Wrap"/>
                                        </ScrollViewer>
                                        <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
                                            <Button Content="Copy Log" Click="CopyLog_Click" Background="#6366F1" Foreground="White" CornerRadius="6"/>
                                            <Button Content="Clear Log" Click="ClearLog_Click" Background="#EF4444" Foreground="White" CornerRadius="6"/>
                                            <Button Content="Full Log" Click="OpenFullLog_Click" Background="#8B5CF6" Foreground="White" CornerRadius="6" Padding="12,8"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Cột 2: Nút Play -->
                            <StackPanel Grid.Row="0" Grid.Column="1"
                                        VerticalAlignment="Bottom"
                                        HorizontalAlignment="Right"
                                        Spacing="12">
                                <Button x:Name="PlayButton"
                                        Content="PLAY"
                                        Click="PlayButton_Click"
                                        Background="#10B981"
                                        Foreground="White"
                                        FontSize="28"
                                        FontWeight="Bold"
                                        Padding="40,16"
                                        CornerRadius="12"
                                        Width="220"
                                        Height="70"
                                        IsEnabled="False"/>
                                <Button Content="Mở thư mục"
                                        Click="OpenFolderButton_Click"
                                        Background="#F59E0B"
                                        Foreground="White"
                                        CornerRadius="8"
                                        Padding="20,10"
                                        Width="220"/>
                                <Button x:Name="InstallButton"
                                        Content="Cài đặt"
                                        Click="InstallButton_Click"
                                        Background="#6366F1"
                                        Foreground="White"
                                        CornerRadius="8"
                                        Padding="20,10"
                                        Width="220"/>
                            </StackPanel>

                            <!-- Thông tin phiên bản -->
                            <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                    Background="#1E293B" CornerRadius="8" Padding="16">
                                <Grid RowDefinitions="Auto,Auto,Auto,Auto"
                                      ColumnDefinitions="Auto,*"
                                      ColumnSpacing="16" RowSpacing="8">
                                    <TextBlock Text="Thông tin"
                                               Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
                                               FontSize="18" FontWeight="SemiBold" Foreground="#93C5FD"/>
                                    <TextBlock Text="Phiên bản:"
                                               Grid.Row="1" Grid.Column="0"
                                               Style="{StaticResource LabelTextStyle}"/>
                                    <TextBlock Text="{Binding SelectedVersion}"
                                               Grid.Row="1" Grid.Column="1"
                                               Style="{StaticResource InfoTextStyle}"/>
                                    <TextBlock Text="Thư mục:"
                                               Grid.Row="2" Grid.Column="0"
                                               Style="{StaticResource LabelTextStyle}"/>
                                    <TextBlock Text="{Binding MinecraftFolder}"
                                               Grid.Row="2" Grid.Column="1"
                                               Style="{StaticResource InfoTextStyle}"
                                               TextWrapping="Wrap"/>
                                    <TextBlock Text="Người chơi:"
                                               Grid.Row="3" Grid.Column="0"
                                               Style="{StaticResource LabelTextStyle}"/>
                                    <TextBlock Text="{Binding UserName}"
                                               Grid.Row="3" Grid.Column="1"
                                               Style="{StaticResource InfoTextStyle}"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- TỐI ƯU HIỆU NĂNG TAB -->
                    <Border x:Name="PerformanceTab"
                            Background="#11002266"
                            BorderBrush="#44FFFFFF"
                            BorderThickness="1"
                            CornerRadius="12"
                            Padding="24"
                            Visibility="Collapsed">
                        <ScrollViewer>
                            <StackPanel Spacing="20">
                                <TextBlock Text="CÀI ĐẶT HIỆU NĂNG TỰ ĐỘNG"
                                           FontSize="28"
                                           FontWeight="Black"
                                           Foreground="#10B981"
                                           HorizontalAlignment="Center"/>
                                <Grid ColumnDefinitions="Auto,*">
                                    <TextBlock Text="RAM:" Grid.Column="0" VerticalAlignment="Center" Foreground="#A5B4FC" FontWeight="SemiBold"/>
                                    <Slider x:Name="RamSlider" Grid.Column="1" Minimum="2048" Maximum="16384" Value="6144"
                                            StepFrequency="512" Width="340" Margin="12,0"/>
                                    <TextBlock Grid.Column="1" HorizontalAlignment="Right" FontWeight="Bold" FontSize="16">
                                        <Run Text="{x:Bind RamSlider.Value, Mode=OneWay}" Foreground="#10B981"/>
                                        <Run Text=" MB" Foreground="#10B981"/>
                                    </TextBlock>
                                </Grid>
                                <Grid ColumnDefinitions="Auto,*">
                                    <TextBlock Text="FPS tối đa:" Grid.Column="0" VerticalAlignment="Center" Foreground="#A5B4FC" FontWeight="SemiBold"/>
                                    <Slider x:Name="FpsSlider" Grid.Column="1" Minimum="60" Maximum="9999" Value="9999"
                                            StepFrequency="100" Width="340" Margin="12,0"/>
                                    <TextBlock Grid.Column="1" HorizontalAlignment="Right" FontWeight="Bold" FontSize="16">
                                        <Run Text="{x:Bind FpsSlider.Value, Mode=OneWay}" Foreground="#FBBF24"/>
                                        <Run Text=" FPS" Foreground="#FBBF24"/>
                                    </TextBlock>
                                </Grid>
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Chế độ hiệu năng:" Foreground="#93C5FD" FontWeight="SemiBold"/>
                                    <ComboBox x:Name="PriorityComboBox" Width="340" SelectedIndex="2" FontSize="15">
                                        <ComboBoxItem Content="Tiết kiệm pin (máy yếu)"/>
                                        <ComboBoxItem Content="Cân bằng (khuyên dùng)"/>
                                        <ComboBoxItem Content="Tối đa FPS (máy mạnh)"/>
                                    </ComboBox>
                                </StackPanel>
                                <Border Background="#1E293B" CornerRadius="12" Padding="16">
                                    <StackPanel Spacing="12">
                                        <TextBlock Text="Tối ưu hiển thị (áp dụng ngay khi vào game)"
                                                   Foreground="#60A5FA" FontWeight="Bold" FontSize="16"/>
                                        <CheckBox x:Name="FastGraphicsCheck" Content="Fast Graphics (tắt fancy)" IsChecked="True"/>
                                        <CheckBox x:Name="NoParticlesCheck" Content="Tắt toàn bộ hạt (Particles: Off)" IsChecked="True"/>
                                        <CheckBox x:Name="VsyncOffCheck" Content="Tắt V-Sync (không giới hạn FPS)" IsChecked="True"/>
                                        <CheckBox x:Name="LowRenderCheck" Content="Khoảng nhìn: 6 chunks (siêu nhẹ)" IsChecked="True"/>
                                        <TextBlock Text="Cài đặt khác" Foreground="#60A5FA" FontWeight="Bold" FontSize="16"/>
                                        <CheckBox x:Name="FullScreen" Content="Full Screen" IsChecked="False"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#10B98120" CornerRadius="12" Padding="16">
                                    <StackPanel Spacing="8">
                                        <TextBlock x:Name="StatusText" Text="Đã sẵn sàng: 3000+ FPS tự động"
                                                   Foreground="#10B981" FontWeight="Bold" FontSize="18"/>
                                        <TextBlock Text="Mọi thay đổi được lưu ngay lập tức. Bấm PLAY là bay!"
                                                   Foreground="#94A3B8" FontSize="14"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </StackPanel>
        </ScrollViewer>

        <!-- ====================== FULL LOG OVERLAY ====================== -->
        <Grid x:Name="FullLogGrid"
              Visibility="Collapsed">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left" Spacing="12" Margin="24,24,0,0">
                <TextBlock Text="FULL LOG"
                           FontSize="28"
                           FontWeight="Bold"
                           Foreground="#10B981"/>
                <Button Content="Trở về"
                        Click="BackToClient_Click"
                        Background="#6366F1"
                        Foreground="White"
                        CornerRadius="8"
                        Padding="16,8"/>
            </StackPanel>

            <!-- Log Content -->
            <ScrollViewer Grid.Row="1"
                          Background="#1E293B"
                          CornerRadius="12"
                          Margin="24,16"
                          Padding="16">
                <TextBlock x:Name="FullLogText"
                           FontFamily="Consolas"
                           FontSize="13"
                           Foreground="#E0E7FF"
                           TextWrapping="Wrap"
                           LineHeight="20"/>
            </ScrollViewer>

            <!-- Copy Button -->
            <Button Grid.Row="2"
                    Content="Copy Toàn Bộ Log"
                    Click="CopyFullLog_Click"
                    HorizontalAlignment="Right"
                    Background="#10B981"
                    Foreground="White"
                    CornerRadius="8"
                    Padding="24,12"
                    Margin="0,12,24,24"/>
        </Grid>
    </Grid>
</Page>